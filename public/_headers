# ---------- HTML: always revalidate ----------
/*
  Cache-Control: public, max-age=0, must-revalidate
  Strict-Transport-Security: max-age=31536000; includeSubDomains; preload
  X-Content-Type-Options: nosniff
  Referrer-Policy: strict-origin-when-cross-origin
  Permissions-Policy: camera=(), microphone=(), geolocation=(), payment=()
  Cross-Origin-Resource-Policy: same-origin
  X-Frame-Options: DENY

  # Site-wide baseline CSP (strict; no inlines). More permissive, per-route CSPs can override below.
  Content-Security-Policy: default-src 'self'; img-src 'self'; style-src 'self'; font-src 'self'; script-src 'self'; connect-src 'self'; object-src 'none'; base-uri 'self'; frame-ancestors 'none'
*/

# ---------- CSP ENFORCED (route override): allow inlines where needed ----------
# References needs inline styles and data: images for the cards; keep scripts self-only.
/references
  Content-Security-Policy: default-src 'self'; img-src 'self' data:; style-src 'self' 'unsafe-inline'; font-src 'self'; script-src 'self'; connect-src 'self'; object-src 'none'; base-uri 'self'; frame-ancestors 'self'; upgrade-insecure-requests

# If you use Cloudflare Turnstile *on any page*, uncomment the block below and
# add it to that pageâ€™s route (NOT globally). Leaving it here as a template.
# /some-page-with-turnstile
#   Content-Security-Policy: default-src 'self'; img-src 'self' data:; style-src 'self' 'unsafe-inline'; font-src 'self'; script-src 'self' https://challenges.cloudflare.com; connect-src 'self' https://challenges.cloudflare.com; frame-src 'self' https://challenges.cloudflare.com; object-src 'none'; base-uri 'self'; frame-ancestors 'self'; upgrade-insecure-requests

# ---------- Optional: keep collecting reports (if you wire a collector) ----------
# /report-uri
#   report-to: /api/csp-report

# ---------- JSON data: never cache ----------
/assets/*.json
  Cache-Control: no-store
  Cross-Origin-Resource-Policy: same-origin

# ---------- JS & CSS: modest cache with background refresh ----------
/assets/*.js
  Cache-Control: public, max-age=86400, stale-while-revalidate=600
  Cross-Origin-Resource-Policy: same-origin

/assets/*.css
  Cache-Control: public, max-age=86400, stale-while-revalidate=600
  Cross-Origin-Resource-Policy: same-origin

# ---------- Images & static media (immutable when fingerprinted) ----------
/assets/img/*
  Cache-Control: public, max-age=604800, immutable
  Cross-Origin-Resource-Policy: same-origin

# ---------- Fallback (defense-in-depth) ----------
# This fallback CSP is redundant with the /* block above and stays here as an
# explicit safety belt for any routes Cloudflare might not match as expected.
/*
  Content-Security-Policy: default-src 'self'; img-src 'self'; style-src 'self' 'unsafe-inline'; font-src 'self'; script-src 'self'; connect-src 'self'; object-src 'none'; base-uri 'self'; frame-ancestors 'none'
  X-Content-Type-Options: nosniff
  Referrer-Policy: no-referrer
  X-Frame-Options: DENY
